import numpy as np
from scipy.integrate import odeint
from matplotlib.pyplot import figure
import matplotlib.pyplot as plot
import matplotlib.pyplot as plt
from colorspacious import cspace_converter
import matplotlib.scale as mscale

csfont = {'fontname':'Arial'}
#############################################################Antibody:
Data1 = np.loadtxt("/Users/suzan/Desktop/Viral/APd1.txt")#Min
Data2 = np.loadtxt("/Users/suzan/Desktop/Viral/APd2.txt")#Mean
Data3 = np.loadtxt("/Users/suzan/Desktop/Viral/APd3.txt")#Max
#
Data4 = np.loadtxt("/Users/suzan/Desktop/Viral/ASd1.txt")#Min
Data5 = np.loadtxt("/Users/suzan/Desktop/Viral/ASd2.txt")#Mean
Data6 = np.loadtxt("/Users/suzan/Desktop/Viral/ASd3.txt")#Max
####
Data7 = np.loadtxt("/Users/suzan/Desktop/APds.txt")#Max


x1 = Data1[:, 0];x2 = Data2[:, 0];x3 = Data3[:, 0];x4 = Data4[:, 0];x5 = Data5[:, 0];x6 = Data6[:, 0];x7 = Data7[:, 0];
y1 = Data1[:, 1];y2 = Data2[:, 1];y3 = Data3[:, 1];y4 = Data4[:, 1];y5 = Data5[:, 1];y6 = Data6[:, 1];y7 = Data7[:, 1];
#*
#*
###

xdata1s = np.array([0.079697142,0.895867696,1.796500646,2.950313597,3.990969039,4.917603699,5.953908256,7.019184175,8.031351686,8.929981848,9.942632791,
10.7865316,12.95237394,15.00602563,18.04611937,20.60692527,21.6482368,23.02784681,23.90164931,25.95423054,26.93953307,30.17593455])
ydata1s = np.array([0.021588671,0.010245295,0.012172115,0.001553887,0.196836056,0.85907165,2.448874238,3.773635486,4.082465363,4.700539487,4.854767959,
4.975929714,5.339549649,5.581738489,5.35976054,5.414032636,5.402606387,5.203325549,4.761286112,5.345806634,5.246057443,5.24486613])
###
xdata2s = np.array([6.021093742,7.060359164,8.106028511,10.19517811,12.0564983,13.04165709,14.16355274,15.12054734,16.05120743,17.09008078,18.07504354,19.00449473,
19.96178338,20.97357074,25.0749575,29.39577668])
ydata2s = np.array([	4.82E-02,0.070436632,2.200218474,5.739350481,6.299824546,6.515584516,6.731442506,6.678365082,6.958602115,6.958602115,7.003063646,6.885450349,
6.929147331,6.90836725,6.674748172,6.656340157])
###
xdata3s = np.array([0.045264809,0.701604538,1.412639244,2.12367395,4.092693137,7.887002735,11.92714707,21.06198872,26.0936665])
ydata3s = np.array([0.062804922,0.062102537,0.06134162,0.060580703,0.058473548,5.704829222,6.89907877,6.760884528,6.798306038])
###
xdata4s = np.array([2.854578097,6.005385996,9.910233393,11.98384201,12.95332136,14.97307002,16.02333932,17.04667864,18.01615799,18.98563734,20.00897666,
21.05924596,23.15978456,23.88689408,27.01077199,])
ydata4s = np.array([0.084805654,0.106007067,1.929328622,1.908127208,2.734982332,3.148409894,2.819787986,3.127208481,3,3.137809187,3.349823322,3,3.06360424,3.116607774,2.766784452])
###
xdata5s = np.array([0.995645583,4.993030898,8.03466238,14.98669258])
ydata5s = np.array([4.48960739,6.599307159,7.27482679,7.441108545])
###
xdata6s = np.array([9.982486865,13.08231173,15.97197898,19.07180385])
ydata6s = np.array([0.061926606,1.207568807,6.811926606,6.780963303])
#****************************************************************************
xdata1 = np.array([4.053028551142937, 7.142379466077003, 10.096018389931025,13.219362927389028])
ydata1 = np.array([5.21047421072171, 7.64100509623089,8.010138711979831,7.974423845910579])
#
xdata2 = np.array([3.9586506434958455,6.94920553881556,9.740122213523124,12.872561317453473,15.920528232105545,19.05288183786861,21.9304081560366,24.936224474216807])
ydata2 = np.array([2.068536552298619,6.118057090790503,6.773569096565294,6.5928357421424115,6.363588284796837,6.207097325006625,6.305063567887376,6.027316664447785])
#
xdata3 = np.array([4.036117716100611,7.176133098267259,10.055295608549375,12.845154070745817,15.889571595723613,19.102561142897414])
ydata3 = np.array([2.3137439537514393,5.719253588260953,7.072359364349581,7.073321661030994,7.33996532329888,7.461797915266863])
#
xdata4 = np.array([3.050479507048391,6.068159931435084,8.908989020666013,12.075007004829214,14.987038122752868,17.981973454640496,20.896641684737958,24.09817827349208,27.05322728375092])
ydata4 = np.array([ -1.7198327317421267,1.343465024122505,2.909853145815813,3.359188805458813,3.190875120965738,2.9749803982510183,3.186862943158448,2.756966567539491,2.7906038751421436])
#
xdata5 = np.array([4.07766990291262,6.923543689320389])
ydata5 = np.array([ -2.1610942249240104,0.3677811550151979])
#
xdata6 = np.array([3.9575971731448742,7.090694935217902,10.058892815076561,13.109540636042404,15.995288574793875])
ydata6 = np.array([ -0.5728400193999867,2.617501558927456,4.93714404489711,5.245077253516246,4.776429016836415])
#
xdata7 = np.array([4.984427335732612,8.070654352551312,11.155010645310721,14.064921919541053])
ydata7 = np.array([ -1.559903256841503,0.6125418685860922,2.5072646450969263,2.5043783851197317])
#
xdata8 = np.array([4.777047751285894,7.829590004636043,10.963384476294301,13.853503221532527,17.07065405261046])
ydata8 = np.array([-0.3743509822986244,0.12079272938317409,0.9924343409702878,0.7110528682796105,1.3474283811640078])
#
xdata9 = np.array([3.1156630708743123,9.107918228877526])
ydata9 = np.array([-2.1914904774009987,2.395307268683548])
#
xdata10 = np.array([10.086992835884107,13.079246415001126,16.0205277212465,19.042549437105205,22.06440646064443])
ydata10 = np.array([2.809145129224653,5.707753479125246,5.838966202783297,5.361829025844928,4.83697813121272])
#
xdata11 = np.array([11.96396716394348,17.942260636198593,20.951337911437367,27.213710632251953,29.936419606914512])
ydata11 = np.array([0.26213592233009564,1.0543689320388339,1.333980582524271,1.3106796116504835,1.9864077669902906])
#
xdata12 = np.array([11.96396716394348,17.942260636198593,20.951337911437367,23.959389059910013,27.213710632251953,29.936419606914512])
ydata12 = np.array([0.26213592233009564,1.0543689320388339,1.333980582524271,1.3106796116504835,1.9864077669902906,1.73009708737864])
#
xdata13 = np.array([6.78343336971373,9.92883109440538,12.89860119903882,15.95960960768578,19.024694794885626,21.92426277283841,25.07006817538535,28.0124423281434])
ydata13 = np.array([-0.7294766231693828,0.003868280449749406,3.619043680935002,4.801179004357493,4.802213341316054,4.755947728710188,5.371182533682926,4.923356563205792])
#
xdata14 = np.array([7.002995794722935,9.800970376986342,12.927993933980872,15.968074318038031,18.850387034349296,21.82127107290387,24.876493245506303])
ydata14 = np.array([-1.5088757396449708,-0.2544378698224854,1.165680473372781,3.224852071005917,4.218934911242604,4.337278106508876,4.195266272189349])
#
xdata15 = np.array([10.057471264367816,12.954022988505745,16.011494252873558,19.14942528735632,22.12643678160919])
ydata15 = np.array([ -0.4880682381723851,1.4687803749132122,2.8043971302939115,2.9434919165537066,3.611776374516479])
#
xdata16 = np.array([7.058810118213014,13.141069046886223,16.259202261664562])
ydata16 = np.array([-0.8713450292397678,2.614035087719297,3.643274853801169])
#
xdata17 = np.array([7.931944813698147,14.092853950888937,16.934382830928314,20.028775391298936,23.046113031230377,26.06107487710922])
ydata17 = np.array([-1.4893343816995976,3.272788673119022,4.837364452464321,5.165957133887309,4.841437242268771,4.866769994852447])
#
xdata18 = np.array([7.931944813698147,14.092853950888937,16.934382830928314,20.028775391298936,23.046113031230377,26.06107487710922,])
ydata18 = np.array([ -1.4893343816995976,3.272788673119022,4.837364452464321,5.165957133887309,4.841437242268771,4.866769994852447])
#
xdata19 = np.array([9.89195654027564,16.05186983624067,18.97153397029983,22.049370139166257,])
ydata19 = np.array([-1.2359767891682782,0.5048355899419743,1.0618955512572548,2.245647969052225])
#
xdata20 = np.array([20.03830763360392,16.95580855416634,22.930953925155773,26.002473003325147,29.07227888980729])
ydata20 = np.array([-1.1573889178747017,2.080623468278704,3.9746036019299043,3.9967104494680825,4.527488383114165])
#
xdata21 = np.array([15.02293975859613,17.89960831218158,21.01738400014608,24.051275496229206,27.088043021748256,30.039168781841752,33.23555594105509])
ydata21 = np.array([-0.15722294249767366,0.9870533024122139,1.4294140204152423,1.5911290469842765,2.173894782973905,2.218706060661395,2.1697861694940013])
#
xdata22 = np.array([16.068324754603545,19.24133520302061])
ydata22 = np.array([-0.4978546178196872,0.6647661911279439])
#
xdata23 = np.array([5.031452212928098,11.1412418551169,20.145536942258694,23.251922079678934,26.074222713232473,29.078810903433812])
ydata23 = np.array([-2.3602687529592146,-2.161544878587696,2.578337429260703,3.067233332581786,2.855252181363153,2.6430004734741717])
#
xdata24 = np.array([2.260981912144703,5.245478036175711,8.13953488372093,10.943152454780364,14.289405684754524,17.002583979328165,20.077519379844965,22.790697674418606,26.046511627906977])
ydata24 = np.array([ -0.6465517241379306,-0.362068965517242,-1.0603448275862064,-0.387931034482758,-0.0775862068965516,-0.2327586206896548,0.8663793103448274,0.8534482758620694,0.4913793103448274])
#
xdata25 = np.array([5.818181818181819,9.181818181818183,11.636363636363637,14.72727272727273,18.090909090909093,20.90909090909091])
ydata25 = np.array([-1.3133673268163513,-1.9145674282333722,-0.9012085528354525,-0.9035073386483372,-0.932039327267093,0.26326168408597894])
#
xdata26 = np.array([7.125651888638755,10.050666312205166,21.97250048078554,25.03218435014763,28.133788476984513])
ydata26 = np.array([-1.6527710216410032,-0.4575494643483342,2.644213038904038,3.2536511420070857,2.8869192393407044])
#
######################################
fig, ax = plot.subplots(figsize=(8,6))
#################################################
colors = ["#7FA998", "#F1F1B0", "#DF8543", "#9D2503", "#FFCC00", "#FF6666",
          "#CC0066", "#66CCCC", "#46185F", "#297CA0", "#BBBBBB", "#E9EA77",
          "#6C5CE7", "#7B88FF", "#17594A", "#8EAC50", "#FF0075", "#ED8E7C",
          "#C84B31", "#C67ACE", "#CE1F6A", "#5A3D55", "#3F3F44", "#21BF73",
          "#E78FB3", "#FF7E67"]

# Ensure you have as many colors as the datasets
assert len(colors) >= 26, "Not enough colors for the datasets"

# Scatter plots
ax.scatter(xdata1, 10**ydata1, color=colors[0], s=200, alpha=1)
ax.scatter(xdata2, 10**ydata2, color=colors[1], s=200, alpha=1)
ax.scatter(xdata3, 10**ydata3, color=colors[2], s=200, alpha=1)
ax.scatter(xdata4, 10**ydata4, color=colors[3], s=200, alpha=1)
ax.scatter(xdata5, 10**ydata5, color=colors[4], s=200, alpha=1)
ax.scatter(xdata6, 10**ydata6, color=colors[5], s=200, alpha=1)
ax.scatter(xdata7, 10**ydata7, color=colors[6], s=200, alpha=1)
ax.scatter(xdata8, 10**ydata8, color=colors[7], s=200, alpha=1)
ax.scatter(xdata9, 10**ydata9, color=colors[8], s=200, alpha=1)
ax.scatter(xdata10, 10**ydata10, color=colors[9], s=200, alpha=1)
ax.scatter(xdata11, 10**ydata11, color=colors[10], s=200, alpha=1)
ax.scatter(xdata12, 10**ydata12, color=colors[11], s=200, alpha=1)
ax.scatter(xdata13, 10**ydata13, color=colors[12], s=200, alpha=1)
ax.scatter(xdata14, 10**ydata14, color=colors[13], s=200, alpha=1)
ax.scatter(xdata15, 10**ydata15, color=colors[14], s=200, alpha=1)
ax.scatter(xdata16, 10**ydata16, color=colors[15], s=200, alpha=1)
ax.scatter(xdata17, 10**ydata17, color=colors[16], s=200, alpha=1)
ax.scatter(xdata18, 10**ydata18, color=colors[17], s=200, alpha=1)
ax.scatter(xdata19, 10**ydata19, color=colors[18], s=200, alpha=1)
ax.scatter(xdata20, 10**ydata20, color=colors[19], s=200, alpha=1)
ax.scatter(xdata21, 10**ydata21, color=colors[20], s=200, alpha=1)
ax.scatter(xdata22, 10**ydata22, color=colors[21], s=200, alpha=1)
ax.scatter(xdata23, 10**ydata23, color=colors[22], s=200, alpha=1)
ax.scatter(xdata24, 10**ydata24, color=colors[23], s=200, alpha=1)
ax.scatter(xdata25, 10**ydata25, color=colors[24], s=200, alpha=1)
ax.scatter(xdata26, 10**ydata26, color=colors[25], s=200, alpha=1)
ax.scatter(xdata1s, 10**ydata1s, color="Orange", s=200, alpha=1)
ax.scatter(xdata2s, 10**ydata2s, color="red", s=200, alpha=1)
ax.scatter(xdata3s, 10**ydata3s, color="black", s=200, alpha=1)
ax.scatter(xdata4s, 10**ydata4s, color="brown", s=200, alpha=1)
ax.scatter(xdata5s, 10**ydata5s, color="blue", s=200, alpha=1)
ax.scatter(xdata6s, 10**ydata6s, color="green", s=200, alpha=1)
####
ax.plot(x1+3.8,y1,linewidth="4",label="",color="#537188",alpha=1)
ax.plot(x2+4.5,y2,linewidth="4",color="#090580",alpha=1,label="1")
ax.plot(x3+4.5,y3,linewidth="4",color="#537188",alpha=1,label="2",linestyle="-")
ax.plot(x7,y7,linewidth="4",color="#090580",alpha=1,label="",linestyle="-")
ax.plot(x7,y7,linewidth="4",color="#537188",alpha=1,label="",linestyle="-")
ax.plot(x7,y7,linewidth="4",color="#537188",alpha=1,label="",linestyle="-")
#Secondary
ax.plot(x4+5,y4,linewidth="4",label="",color="#537188",alpha=1,linestyle="--")
ax.plot(x5+5.3,y5,linewidth="4",color="#090580",alpha=1,label="3",linestyle="--")
ax.plot(x6+5.3,y6,linewidth="4",color="#537188",alpha=1,label="3",linestyle="--")
####
# ax.set_xlim(0,800)
ax.set_xlim(-1,32)
ax.set_ylim(0.65,10000000000)
# ax.set_yscale('log')
ax = plt.gca()  # Get the current axis
ax.set_yscale(mscale.LogScale(ax, base=2))
ax.set_ylabel(r'Antibody $log_{10}(ng/ml)$',**csfont,size=20)
ax.set_xlabel('Time (days)',**csfont,size=20)
ax.legend(shadow=True,fontsize=15,loc="lower left")
# # axs[1, 2].set_xlim(0, 60)
ax.tick_params(direction="in")
ax.tick_params(axis='both',labelsize=20)
ax.set_yticklabels(['1','3','5','7','9'],**csfont,size=20)
ax.set_yticks([10,10**3,10**5,10**7,10**9])
plot.savefig('/Users/suzan/Desktop/FABS',bbox_inches='tight')
plot.show()
